<app-loading [loadingState]="loadingState">
  <app-shows
    [showsInfos]="showsInfos"
    [tmdbConfig]="tmdbService.tmdbConfig$ | async"
    [withEpisode]="true"
    [withEpisodesCount]="true"
    [withProgressbar]="true"
    [menu]="menu"
    (addFavorite)="showService.addFavorite($event)"
    (removeFavorite)="showService.removeFavorite($event)"
    (manageLists)="dialogService.manageListsViaDialog($event)"
  ></app-shows>
</app-loading>

<mat-menu #menu="matMenu">
  <ng-template matMenuContent let-show="show" let-isFavorite="isFavorite">
    <ng-container *ngIf="show">
      <button mat-menu-item (click)="dialogService.syncAddShow(show)">Mark as seen</button>

      <ng-container *ngIf="listService.lists$ | async as lists">
        <button
          *ngIf="lists.length > 0"
          mat-menu-item
          (click)="dialogService.manageListsViaDialog(show.ids.trakt)"
        >
          Manage lists
        </button>
      </ng-container>

      <button
        mat-menu-item
        (click)="isFavorite ? showService.removeFavorite(show) : showService.addFavorite(show)"
      >
        {{ isFavorite ? 'Remove favorite' : 'Add favorite' }}
      </button>
      <button mat-menu-item (click)="dialogService.syncRemoveShow(show)">Remove show</button>
    </ng-container>
  </ng-template>
</mat-menu>
