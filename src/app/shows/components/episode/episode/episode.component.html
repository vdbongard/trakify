<t-loading [loadingState]="pageState">
  <t-breadcrumb [parts]="breadcrumbParts"></t-breadcrumb>

  <div *ngIf="breadcrumbParts" class="title-wrapper">
    <div class="left">
      <h1 class="mat-headline title">
        {{ episodeInfo | episodeTitle }}
      </h1>
      <h2 *ngIf="episodeInfo?.episode?.first_aired" class="mat-subheading-1 subtitle">
        {{ episodeInfo?.episode?.first_aired | date: 'd. MMM. yyyy (E.)' }}
      </h2>
    </div>
    <div class="right">
      <ng-container *ngIf="params && episodeInfo?.episodes">
        <a
          mat-icon-button
          aria-label="Previous episode"
          [routerLink]="params | episodeLinkWithCounter: -1"
          [disabled]="params['episode'] === '1'"
        >
          <mat-icon>navigate_before</mat-icon>
        </a>
        <a
          mat-icon-button
          aria-label="Next episode"
          [routerLink]="params | episodeLinkWithCounter: 1:episodeInfo?.episodes?.length"
          [disabled]="params['episode'] === episodeInfo?.episodes?.length + ''"
        >
          <mat-icon>navigate_next</mat-icon>
        </a>
      </ng-container>
    </div>
  </div>

  <t-loading [loadingState]="episodeState">
    <t-episode
      *ngIf="episodeInfo && episodeInfo.episode && episodeInfo.show"
      [show]="episodeInfo.show"
      [episode]="episodeInfo.episode"
      [episodeProgress]="episodeInfo.episodeProgress"
      [tmdbEpisode]="episodeInfo.tmdbEpisode"
      [isSeenLoading]="(seenState | async) === state.LOADING"
      (add)="executeService.addEpisode(episodeInfo.episode, episodeInfo.show.ids, seenState)"
      (remove)="executeService.removeEpisode(episodeInfo.episode, episodeInfo.show.ids, seenState)"
    ></t-episode>
  </t-loading>
</t-loading>
