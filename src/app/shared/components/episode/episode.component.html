<a
  *ngIf="episode !== null && show && params"
  class="link"
  [routerLink]="
    episode &&
    '/series/s/' +
      (params.slug ?? show.ids?.slug) +
      '/season/' +
      (params.season ?? episode?.season) +
      '/episode/' +
      (params.number ?? episode?.number)
  "
>
  <img
    [src]="imgPrefix && tmdbEpisode?.still_path && imgPrefix + tmdbEpisode?.still_path"
    alt="Episode still"
    class="still"
    loading="lazy"
    width="1920"
    height="1080"
    appImageFallback
    imageFallback="assets/still.png"
  />
</a>

<ng-container *ngIf="episodeProgress || (episode?.season === 1 && episode?.number === 1)">
  <button
    *ngIf="!episodeProgress?.completed"
    mat-flat-button
    color="primary"
    (click)="addToHistory.emit()"
    class="mark-button"
  >
    Mark as seen
  </button>
  <button
    *ngIf="episodeProgress?.completed"
    mat-flat-button
    color="primary"
    (click)="removeFromHistory.emit()"
    class="mark-button"
  >
    Mark as unseen
  </button></ng-container
>

<ng-container *ngIf="episode">
  <p class="mat-body">
    {{ episode?.overview ?? 'No episode description.' }}
  </p>
  <p class="mat-body source">Source: TMDB</p>
</ng-container>
