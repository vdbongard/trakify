<t-loading [loadingState]="loadingState">
  <ng-container *ngIf="episodeInfo as info">
    <t-breadcrumb [parts]="breadcrumbParts"></t-breadcrumb>

    <div class="title-wrapper">
      <div class="left">
        <h1 class="mat-headline title">
          {{ info | episodeTitle }}
        </h1>
        <h2 *ngIf="info.episode?.first_aired" class="mat-subheading-1 subtitle">
          {{ info.episode?.first_aired | date: 'd. MMM. yyyy (E.)' }}
        </h2>
      </div>
      <div class="right">
        <ng-container *ngIf="params && episodeInfo.episodes">
          <a
            mat-icon-button
            aria-label="Previous episode"
            [routerLink]="
              this.params.get('episode') !== '1'
                ? '/series/s/' +
                  this.params.get('slug') +
                  '/season/' +
                  this.params.get('season') +
                  '/episode/' +
                  (this.params.get('episode') | getEpisodeNumber: -1)
                : null
            "
            [disabled]="this.params.get('episode') === '1'"
          >
            <mat-icon>navigate_before</mat-icon>
          </a>
          <a
            mat-icon-button
            aria-label="Next episode"
            [routerLink]="
              this.params.get('episode') !== episodeInfo.episodes.length.toString()
                ? '/series/s/' +
                  this.params.get('slug') +
                  '/season/' +
                  this.params.get('season') +
                  '/episode/' +
                  (this.params.get('episode') | getEpisodeNumber: 1:episodeInfo.episodes.length)
                : null
            "
            [disabled]="this.params.get('episode') === episodeInfo.episodes.length.toString()"
          >
            <mat-icon>navigate_next</mat-icon>
          </a>
        </ng-container>
      </div>
    </div>

    <t-episode
      [show]="info.show"
      [episode]="info.episode"
      [episodeProgress]="info.episodeProgress"
      [tmdbEpisode]="info.tmdbEpisode"
      [imgPrefix]="stillPrefix"
      [isSeenLoading]="(seenLoading | async) === loadingStateEnum.LOADING"
      (add)="executeService.addEpisode(info.episode, info.show?.ids, seenLoading)"
      (remove)="executeService.removeEpisode(info.episode, info.show?.ids, seenLoading)"
    ></t-episode>
  </ng-container>
</t-loading>
