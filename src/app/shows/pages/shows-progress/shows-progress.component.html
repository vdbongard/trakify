<t-loading [loadingState]="pageState">
  <t-shows
    [isLoggedIn]="authService.isLoggedIn$ | async"
    [showsInfos]="showsInfos"
    [withEpisode]="true"
    [withEpisodesCount]="true"
    [withProgressbar]="true"
    [menu]="menu"
    [back]="router.url"
    (addFavorite)="showService.addFavorite($event)"
    (removeFavorite)="showService.removeFavorite($event)"
  ></t-shows>
</t-loading>

<a
  mat-fab
  color="primary"
  class="fab"
  aria-label="Add show to watchlist"
  [routerLink]="{} | ngGenericPipe : paths.addShow"
>
  <mat-icon>add</mat-icon>
</a>

<mat-menu #menu="matMenu">
  <ng-template matMenuContent let-show="show" let-isFavorite="isFavorite" let-isHidden="isHidden">
    <ng-container *ngIf="show">
      <ng-container *ngIf="listService.lists.$ | async as lists">
        <button
          *ngIf="lists.length > 0"
          mat-menu-item
          (click)="dialogService.manageLists(show.ids.trakt)"
        >
          Manage lists
        </button>
      </ng-container>

      <button mat-menu-item (click)="executeService.addShow(show, { showConfirm: true })">
        Mark as seen
      </button>

      <button
        *ngIf="isFavorite !== undefined"
        mat-menu-item
        (click)="isFavorite ? showService.removeFavorite(show) : showService.addFavorite(show)"
      >
        {{ isFavorite ? 'Remove favorite' : 'Add favorite' }}
      </button>

      <button
        *ngIf="isHidden !== undefined"
        mat-menu-item
        (click)="
          isHidden ? executeService.removeShowHidden(show) : executeService.addShowHidden(show)
        "
      >
        {{ isHidden ? 'Unhide show' : 'Hide show' }}
      </button>

      <button mat-menu-item (click)="executeService.removeShow(show)">Remove show</button>
    </ng-container>
  </ng-template>
</mat-menu>
