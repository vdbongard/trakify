"use strict";(self.webpackChunktrakify=self.webpackChunktrakify||[]).push([[486],{2486:(W,v,i)=>{i.r(v),i.d(v,{ListsModule:()=>g});var f=i(6895),p=i(7392),r=i(3848),x=i(4859),Z=i(6709),A=i(7274),l=i(858),I=i(1135),L=i(9841),S=i(4004),y=i(3900),d=i(9646),N=i(2722),P=i(1850),Y=i(5606),c=i(975),b=i(5022),t=i(4650),w=i(5507),J=i(6578),O=i(5381),Q=i(7009),U=i(1481),T=i(4602),C=i(8424);const B=function(){return[]},j=function(o){return{slug:o}};function F(o,a){if(1&o&&(t.TgZ(0,"a",10),t._uU(1),t.qZA()),2&o){const s=a.$implicit,n=a.index,e=t.oxw(3);t.Q6J("active",e.activeListIndex===n)("routerLink",t.DdM(4,B))("queryParams",t.VKq(5,j,s.ids.slug)),t.xp6(1),t.hij(" ",s.name," ")}}function M(o,a){if(1&o&&(t.TgZ(0,"nav",8),t.YNc(1,F,2,7,"a",9),t.qZA()),2&o){const s=t.oxw(2),n=t.MAs(3);t.Q6J("tabPanel",n)("mat-stretch-tabs",!1),t.xp6(1),t.Q6J("ngForOf",s.lists)}}function G(o,a){if(1&o&&(t.ynx(0),t.YNc(1,M,2,3,"nav",7),t.BQk()),2&o){const s=t.oxw(),n=t.MAs(7);t.xp6(1),t.Q6J("ngIf",s.lists.length)("ngIfElse",n)}}function z(o,a){if(1&o&&(t.TgZ(0,"t-loading",0),t._UZ(1,"t-shows",11),t.qZA()),2&o){const s=t.oxw();t.Q6J("loadingState",s.listItemsLoadingState),t.xp6(1),t.Q6J("showsInfos",s.showsInfos)("back",s.router.url)}}function $(o,a){if(1&o){const s=t.EpF();t.TgZ(0,"button",12),t.NdJ("click",function(){t.CHM(s);const e=t.oxw();return t.KtG(e.dialogService.manageListItems(null==e.lists?null:e.lists[e.activeListIndex]))}),t.TgZ(1,"mat-icon"),t._uU(2,"add"),t.qZA()()}}function D(o,a){1&o&&(t.TgZ(0,"div",2)(1,"h2",13),t._uU(2,"No list added."),t.qZA()())}class h extends P.X{constructor(a,s,n,e,u,H,k,K){super(),this.tmdbService=a,this.router=s,this.route=n,this.listService=e,this.dialogService=u,this.snackBar=H,this.title=k,this.cdr=K,this.pageState=new I.X(c.Gu.LOADING),this.listItemsLoadingState=new I.X(c.Gu.LOADING),this.activeListIndex=0}ngOnInit(){(0,L.a)([this.listService.lists.$,this.route.queryParams]).pipe((0,S.U)(([a,s])=>[a,E.parse(s)]),(0,y.w)(([a,s])=>{if(this.pageState.next(c.Gu.SUCCESS),this.title.setTitle("Lists - Trakify"),this.lists=a,!this.lists||0===this.lists.length)return(0,d.of)([]);const n=s.slug,e=null!==n?this.lists.findIndex(u=>u.ids.slug===n):-1;return this.activeListIndex=e>=0?e:0,this.title.setTitle(`${this.lists[this.activeListIndex].name} - Lists - Trakify`),n&&-1!==e?this.listService.getListItems$(n):(this.router.navigate([],{queryParamsHandling:"merge",queryParams:{slug:this.lists[this.activeListIndex].ids.slug}}),(0,d.of)([]))}),(0,y.w)(a=>{if(this.listItemsLoadingState.next(c.Gu.SUCCESS),!a||0===a.length)return this.showsInfos=[],(0,d.of)([]);const s=a.map(n=>({show:n.show}));return s?.sort((n,e)=>n.show?e.show&&n.show.title>e.show.title?1:-1:1),this.showsInfos=s,console.debug("showsInfos",this.showsInfos),(0,L.a)(this.showsInfos.map(n=>this.tmdbService.getTmdbShow$(n.show,{fetch:!0})))}),(0,S.U)(a=>{0!==a.length&&(this.showsInfos=this.showsInfos?.map((s,n)=>({...s,tmdbShow:a[n]})))}),(0,N.R)(this.destroy$)).subscribe({next:()=>this.cdr.markForCheck(),error:a=>(0,Y.q)(a,this.snackBar,this.pageState)})}static#t=this.\u0275fac=function(s){return new(s||h)(t.Y36(w.U),t.Y36(l.F0),t.Y36(l.gz),t.Y36(J.X),t.Y36(O.x),t.Y36(Q.ux),t.Y36(U.Dx),t.Y36(t.sBO))};static#s=this.\u0275cmp=t.Xpm({type:h,selectors:[["t-lists"]],features:[t.qOj],decls:8,vars:4,consts:[[3,"loadingState"],[4,"ngIf"],[1,"list"],["tabPanel",""],[3,"loadingState",4,"ngIf"],["mat-fab","","color","primary","class","fab","aria-label","Add list items",3,"click",4,"ngIf"],["noList",""],["mat-tab-nav-bar","","color","accent",3,"tabPanel","mat-stretch-tabs",4,"ngIf","ngIfElse"],["mat-tab-nav-bar","","color","accent",3,"tabPanel","mat-stretch-tabs"],["mat-tab-link","",3,"active","routerLink","queryParams",4,"ngFor","ngForOf"],["mat-tab-link","",3,"active","routerLink","queryParams"],[3,"showsInfos","back"],["mat-fab","","color","primary","aria-label","Add list items",1,"fab",3,"click"],[1,"mat-body-2"]],template:function(s,n){1&s&&(t.TgZ(0,"t-loading",0),t.YNc(1,G,2,2,"ng-container",1),t.TgZ(2,"mat-tab-nav-panel",2,3),t.YNc(4,z,2,3,"t-loading",4),t.qZA(),t.YNc(5,$,3,0,"button",5),t.qZA(),t.YNc(6,D,3,0,"ng-template",null,6,t.W1O)),2&s&&(t.Q6J("loadingState",n.pageState),t.xp6(1),t.Q6J("ngIf",n.lists),t.xp6(3),t.Q6J("ngIf",null==n.lists?null:n.lists.length),t.xp6(1),t.Q6J("ngIf",void 0!==n.activeListIndex))},dependencies:[f.sg,f.O5,l.rH,p.Hw,r.BU,r.sW,r.Nj,x.cs,T.j,C.N],styles:[".list[_ngcontent-%COMP%]{display:block;max-width:55rem;margin:0 auto;padding:1rem}.list[_ngcontent-%COMP%]     .mat-mdc-list-base{margin-left:-1rem;margin-right:-1rem}"],changeDetection:0})}const E=b.z.object({slug:b.z.string().optional()}),X=[{path:"",component:h}];class m{static#t=this.\u0275fac=function(s){return new(s||m)};static#s=this.\u0275mod=t.oAB({type:m});static#n=this.\u0275inj=t.cJS({imports:[l.Bz.forChild(X),l.Bz]})}class g{static#t=this.\u0275fac=function(s){return new(s||g)};static#s=this.\u0275mod=t.oAB({type:g});static#n=this.\u0275inj=t.cJS({imports:[f.ez,m,p.Ps,r.Nh,x.ot,Z.p9,A.Is,T.j,C.N]})}}}]);